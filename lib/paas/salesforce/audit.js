
/* --------------------------------------------------------------------------
 * This file is subject to the terms and conditions defined in
 * file https://github.com/HardingPoint/GRAXForSFDC/blob/master/LICENSE,
 * which is part of this source code package.
 * --------------------------------------------------------------------------
 *          Copyright (c) 2017-2020 Harding Point
 *                  All rights reserved
 *             Built: Fri Sep 28 2018 15:33:58 GMT-0400 (EDT)
 * --------------------------------------------------------------------------
 * Support:	Support@Grax.io
 * Website:	https://grax.io
 * Github:	https://github.com/HardingPoint/grax-secure
 * License:	https://github.com/HardingPoint/grax-secure/blob/master/LICENSE
 * --------------------------------------------------------------------------*/

var _0x4a4b=['\x66\x6f\x72\x45\x61\x63\x68','\x61\x75\x64\x69\x74\x70\x61\x74\x68','\x61\x75\x64\x69\x74\x66\x75\x6c\x6c\x70\x61\x74\x68','\x70\x75\x74\x66\x69\x6c\x65','\x73\x33\x63\x6f\x6e\x74\x65\x6e\x74\x74\x79\x70\x65','\x73\x33\x63\x75\x73\x74\x6f\x6d\x65\x72\x73\x74\x6f\x72\x61\x67\x65\x2e\x70\x75\x74\x66\x69\x6c\x65','\x70\x75\x73\x68','\x20\x46\x69\x6c\x65\x6e\x61\x6d\x65\x3a\x20','\x50\x72\x6f\x63\x65\x73\x73\x53\x33\x20\x2d\x20\x73\x66\x64\x63\x72\x65\x71\x75\x65\x73\x74\x2e\x6e\x65\x77\x2e\x6c\x65\x6e\x67\x74\x68\x20\x3d\x3d\x20\x30\x20\x4e\x6f\x74\x68\x69\x6e\x67\x20\x74\x6f\x20\x50\x72\x6f\x63\x65\x73\x73','\x53\x33\x20\x45\x78\x63\x65\x70\x74\x69\x6f\x6e','\x4c\x61\x73\x74\x4d\x6f\x64\x69\x66\x69\x65\x64\x44\x61\x74\x65','\x53\x79\x73\x74\x65\x6d\x4d\x6f\x64\x73\x74\x61\x6d\x70','\x43\x6f\x6d\x70\x61\x72\x65\x4e\x61\x6d\x65','\x27\x2c\x27','\x6e\x65\x77\x76\x61\x6c\x75\x65','\x6f\x6c\x64\x76\x61\x6c\x75\x65','\x74\x6f\x53\x74\x72\x69\x6e\x67','\x72\x65\x70\x6c\x61\x63\x65','\x63\x6f\x6e\x73\x74\x72\x75\x63\x74\x6f\x72','\x64\x65\x62\x75\x67\x67\x65\x72','\x2e\x2e\x2f\x61\x6d\x61\x7a\x6f\x6e\x2f\x73\x33\x63\x75\x73\x74\x6f\x6d\x65\x72\x73\x74\x6f\x72\x61\x67\x65','\x2e\x2e\x2f\x2e\x2e\x2f\x61\x70\x70\x6c\x69\x63\x61\x74\x69\x6f\x6e\x73\x2f\x65\x6c\x61\x73\x74\x69\x63\x2f\x67\x72\x61\x78\x2d\x65\x6c\x61\x73\x74\x69\x63','\x2e\x2e\x2f\x2e\x2e\x2f\x63\x6f\x6d\x6d\x6f\x6e\x2f\x67\x72\x61\x78\x2d\x67\x6c\x6f\x62\x61\x6c\x73','\x6c\x69\x62\x2e\x73\x61\x6c\x65\x73\x66\x6f\x72\x63\x65\x2e\x61\x75\x64\x69\x74','\x65\x78\x70\x6f\x72\x74\x73','\x69\x6e\x73\x65\x72\x74\x67\x72\x61\x78\x61\x75\x64\x69\x74','\x77\x72\x69\x74\x65','\x69\x6e\x73\x65\x72\x74\x61\x75\x64\x69\x74\x20\x45\x78\x63\x65\x70\x74\x69\x6f\x6e','\x6f\x6c\x64','\x6e\x65\x77','\x6c\x65\x6e\x67\x74\x68','\x75\x70\x73\x65\x72\x74','\x73\x74\x72\x69\x6e\x67\x69\x66\x79','\x50\x41\x41\x53','\x41\x4d\x41\x5a\x4f\x4e','\x44\x49\x53\x41\x42\x4c\x45\x44','\x49\x53\x43\x4f\x4e\x46\x49\x47\x55\x52\x45\x44'];(function(_0x11005e,_0x20c3d2){var _0x29338f=function(_0x3384e9){while(--_0x3384e9){_0x11005e['push'](_0x11005e['shift']());}};var _0x2d1eb3=function(){var _0x314a2b={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x97e370,_0x183caa,_0x44ba48,_0x47043f){_0x47043f=_0x47043f||{};var _0x596be7=_0x183caa+'='+_0x44ba48;var _0x454f2a=0x0;for(var _0x454f2a=0x0,_0xc4e080=_0x97e370['length'];_0x454f2a<_0xc4e080;_0x454f2a++){var _0x36866e=_0x97e370[_0x454f2a];_0x596be7+=';\x20'+_0x36866e;var _0x1d97d9=_0x97e370[_0x36866e];_0x97e370['push'](_0x1d97d9);_0xc4e080=_0x97e370['length'];if(_0x1d97d9!==!![]){_0x596be7+='='+_0x1d97d9;}}_0x47043f['cookie']=_0x596be7;},'removeCookie':function(){return'dev';},'getCookie':function(_0x1d2ed0,_0x50b061){_0x1d2ed0=_0x1d2ed0||function(_0xb6ba8e){return _0xb6ba8e;};var _0x374c3d=_0x1d2ed0(new RegExp('(?:^|;\x20)'+_0x50b061['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0x262b02=function(_0x3c4db2,_0x2db9da){_0x3c4db2(++_0x2db9da);};_0x262b02(_0x29338f,_0x20c3d2);return _0x374c3d?decodeURIComponent(_0x374c3d[0x1]):undefined;}};var _0x2beb20=function(){var _0x30111e=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x30111e['test'](_0x314a2b['removeCookie']['toString']());};_0x314a2b['updateCookie']=_0x2beb20;var _0x1969ba='';var _0x3a7a01=_0x314a2b['updateCookie']();if(!_0x3a7a01){_0x314a2b['setCookie'](['*'],'counter',0x1);}else if(_0x3a7a01){_0x1969ba=_0x314a2b['getCookie'](null,'counter');}else{_0x314a2b['removeCookie']();}};_0x2d1eb3();}(_0x4a4b,0x1ab));var _0xb4a4=function(_0x3a9b99,_0xb7f172){_0x3a9b99=_0x3a9b99-0x0;var _0x4efe4a=_0x4a4b[_0x3a9b99];return _0x4efe4a;};var _0x334403=function(){var _0x172894=!![];return function(_0x3733b9,_0x12dd35){var _0xa68515=_0x172894?function(){if(_0x12dd35){var _0x368c19=_0x12dd35['apply'](_0x3733b9,arguments);_0x12dd35=null;return _0x368c19;}}:function(){};_0x172894=![];return _0xa68515;};}();var _0x15f6ec=_0x334403(this,function(){var _0x361a0d=function(){return'\x64\x65\x76';},_0x161c0f=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0x36d2d2=function(){var _0x3a8590=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x3a8590['\x74\x65\x73\x74'](_0x361a0d['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0xda61d4=function(){var _0x43b99f=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0x43b99f['\x74\x65\x73\x74'](_0x161c0f['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x553804=function(_0x114130){var _0x3fa00=~-0x1>>0x1+0xff%0x0;if(_0x114130['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x3fa00)){_0x3c7ede(_0x114130);}};var _0x3c7ede=function(_0x122ca4){var _0x38a387=~-0x4>>0x1+0xff%0x0;if(_0x122ca4['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x38a387){_0x553804(_0x122ca4);}};if(!_0x36d2d2()){if(!_0xda61d4()){_0x553804('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x553804('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x553804('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x15f6ec();var S3CustomerStorage=require(_0xb4a4('0x0'));var SFDCParser=require('\x2e\x2f\x72\x65\x71\x75\x65\x73\x74\x70\x61\x72\x73\x65\x72');var GRAXes=require(_0xb4a4('0x1'));var GRAXGlobals=require(_0xb4a4('0x2'));var GRAXDebugger=new GRAXDebugging({'source':_0xb4a4('0x3')});module[_0xb4a4('0x4')]=GRAXAuditTrail;function GRAXAuditTrail(_0x4306d8){this['\x73\x66\x72\x65\x71\x75\x65\x73\x74']=new SFDCParser(_0x4306d8);}module[_0xb4a4('0x4')][_0xb4a4('0x5')]=insertaudit;function insertaudit(_0x54f2e3,_0x30f8e9){try{_0x54f2e3=NormalizeRecords(_0x54f2e3);ProcessS3(_0x54f2e3,function(_0x5d8ed0,_0x325b06){if(_0x5d8ed0)_0x30f8e9(_0x5d8ed0,_0x325b06);else{ProcessElastic(_0x54f2e3,function(_0x117449,_0x2b65e7){_0x30f8e9(_0x117449,'');});}});}catch(_0x5628db){GRAXDebugger[_0xb4a4('0x6')]({'info':_0xb4a4('0x7'),'err':_0x5628db});_0x30f8e9(_0x5628db,null);}}setInterval(function(){_0xd6abcf();},0xfa0);function NormalizeRecords(_0x2f83d9){if(_0x2f83d9[_0xb4a4('0x8')]===null||_0x2f83d9[_0xb4a4('0x8')]===undefined)_0x2f83d9['\x6f\x6c\x64']=[];if(_0x2f83d9[_0xb4a4('0x9')]===null||_0x2f83d9['\x6e\x65\x77']===undefined)_0x2f83d9[_0xb4a4('0x9')]=[];if(_0x2f83d9[_0xb4a4('0x8')][_0xb4a4('0xa')]===0x0)_0x2f83d9[_0xb4a4('0x8')]=_0x2f83d9['\x6e\x65\x77'];if(_0x2f83d9!==null&&_0x2f83d9!==undefined){if(_0x2f83d9[_0xb4a4('0x8')]===null||_0x2f83d9[_0xb4a4('0x8')]===undefined){return _0x2f83d9;}else{if(_0x2f83d9['\x6e\x65\x77']['\x6c\x65\x6e\x67\x74\x68']===0x0&&_0x2f83d9[_0xb4a4('0x8')][_0xb4a4('0xa')]>0x0){_0x2f83d9[_0xb4a4('0x9')]=_0x2f83d9[_0xb4a4('0x8')];for(item in _0x2f83d9[_0xb4a4('0x9')]){_0x2f83d9['\x6e\x65\x77'][item]['\x49\x73\x44\x65\x6c\x65\x74\x65\x64']=!![];}return _0x2f83d9;}else{return _0x2f83d9;}}}else{return _0x2f83d9;}}function GetReturnValue(_0x475549,_0x404bf5,_0x186921){return{'sql':_0x475549,'fileresults':_0x404bf5,'lasterror':_0x186921};}function ProcessElastic(_0x561be6,_0x182d20){try{var _0x4dfc31=new GRAXes(_0x561be6);if(_0x4dfc31['\x69\x73\x63\x6f\x6e\x66\x69\x67\x75\x72\x65\x64']){_0x4dfc31[_0xb4a4('0xb')](_0x561be6,function(_0x1e30fc,_0x4816ba){if(_0x1e30fc){GRAXDebugger[_0xb4a4('0x6')]({'info':'\x45\x6c\x61\x73\x74\x69\x63\x20\x45\x72\x72\x6f\x72','err':_0x1e30fc});GRAXDebugger[_0xb4a4('0x6')]({'info':JSON[_0xb4a4('0xc')](_0x561be6)});}_0x182d20(_0x1e30fc,_0x4816ba);});}else{GRAXDebugger[_0xb4a4('0x6')]({'info':'\x67\x72\x61\x78\x45\x53\x2e\x75\x70\x73\x65\x72\x74','err':'\x45\x6c\x61\x73\x74\x69\x63\x20\x4e\x4f\x54\x20\x43\x6f\x6e\x66\x69\x67\x75\x72\x65\x64'});_0x182d20(null,null);}}catch(_0x463fec){GRAXDebugger[_0xb4a4('0x6')]({'info':'\x45\x6c\x61\x73\x74\x69\x63\x20\x45\x78\x63\x65\x70\x74\x69\x6f\x6e','err':_0x463fec});_0x182d20(_0x463fec,null);}}function ProcessS3(_0x5c6623,_0x5d3ae1){try{var _0x4d8939=[];var _0x578bf9='';var _0x6c7d96=null;var _0x501df7=new SFDCParser(_0x5c6623);var _0x3e77d9=new GRAXConfiguration(_0x5c6623);if(_0x3e77d9['\x47\x52\x41\x58'][_0xb4a4('0xd')][_0xb4a4('0xe')]['\x53\x33'][_0xb4a4('0xf')]===![]&&_0x3e77d9['\x47\x52\x41\x58'][_0xb4a4('0xd')]['\x41\x4d\x41\x5a\x4f\x4e']['\x53\x33'][_0xb4a4('0x10')]===!![]){var _0x5e0294=new S3CustomerStorage(_0x3e77d9);if(_0x5c6623['\x6e\x65\x77']['\x6c\x65\x6e\x67\x74\x68']>0x0){var _0x2aa5e6=_0x5c6623[_0xb4a4('0x9')][_0xb4a4('0xa')];var _0x31c454=0x0;var _0x2602ce='';var _0x4d3544='';var _0x33ba95='';var _0x3eb2cd=0x0;_0x5c6623['\x6e\x65\x77'][_0xb4a4('0x11')](function(_0x31c52d){_0x2602ce=_0x501df7[_0xb4a4('0x12')](_0x31c52d);_0x33ba95=_0x501df7[_0xb4a4('0x13')](_0x31c52d);_0x4d3544={'new':[_0x31c52d],'old':[_0x5c6623['\x6f\x6c\x64'][_0x31c454]]};_0x5e0294[_0xb4a4('0x14')]({'filename':_0x33ba95,'filedata':JSON[_0xb4a4('0xc')](_0x4d3544),'contenttype':_0x501df7[_0xb4a4('0x15')]},function(_0x3a8a74,_0x1af580){if(_0x3a8a74){GRAXDebugger[_0xb4a4('0x6')]({'info':_0xb4a4('0x16'),'err':_0x3a8a74});_0x4d8939[_0xb4a4('0x17')](_0x3a8a74);_0x578bf9+=_0x3a8a74+'\x20\x5b\x42\x75\x63\x6b\x65\x74\x3a\x20'+_0x2602ce+_0xb4a4('0x18')+_0x33ba95+'\x5d\x0a';if(_0x2aa5e6===_0x4d8939[_0xb4a4('0xa')]){_0x5d3ae1(_0x578bf9,_0x4d8939);}}else{_0x4d8939[_0xb4a4('0x17')](_0x1af580);if(_0x2aa5e6===_0x4d8939[_0xb4a4('0xa')]){_0x5d3ae1(_0x578bf9,GetReturnValue('',_0x4d8939,_0x578bf9));}_0x3eb2cd++;}});_0x31c454++;});}else{GRAXDebugger[_0xb4a4('0x6')]({'info':_0xb4a4('0x19')});_0x5d3ae1(null,'');}}else{_0x5d3ae1(null,'');}}catch(_0x2c158a){GRAXDebugger['\x77\x72\x69\x74\x65']({'info':_0xb4a4('0x1a'),'err':_0x2c158a});_0x5d3ae1(_0x2c158a,null);}}function ProcessAuditTrail(_0x43b533,_0xc08a80){_0xc08a80(null,'');}function storeaudittrail(_0x2916d6,_0x557e79,_0x5073b9){var _0x48a332=_0x2916d6[_0xb4a4('0x9')][_0x557e79]['\x61\x74\x74\x72\x69\x62\x75\x74\x65\x73']['\x74\x79\x70\x65'];var _0x308a6a=_0x2916d6[_0xb4a4('0x9')][_0x557e79]['\x49\x64'];var _0x41ea1f={};var _0x11a193='';var _0x2862ed='';var _0x5180d6='';var _0x476634='';var _0x3e1f98='';for(var _0x1ed635 in _0x2916d6['\x6e\x65\x77'][_0x557e79]){_0x476634='';_0x3e1f98='';if(_0x2916d6[_0xb4a4('0x9')]){if(_0x2916d6[_0xb4a4('0x9')][_0x557e79])_0x3e1f98=NormalizeFieldValue(_0x2916d6[_0xb4a4('0x9')][_0x557e79][_0x1ed635]);}if(_0x2916d6[_0xb4a4('0x8')]){if(_0x2916d6['\x6f\x6c\x64'][_0x557e79])_0x476634=NormalizeFieldValue(_0x2916d6[_0xb4a4('0x8')][_0x557e79][_0x1ed635]);}if(_0x3e1f98!==_0x476634&&_0x1ed635!==_0xb4a4('0x1b')&&_0x1ed635!==_0xb4a4('0x1c')&&_0x1ed635!=='\x61\x74\x74\x72\x69\x62\x75\x74\x65\x73'&&_0x1ed635!==_0xb4a4('0x1d')){_0x11a193=_0x2916d6[_0xb4a4('0x9')][_0x557e79]['\x4c\x61\x73\x74\x4d\x6f\x64\x69\x66\x69\x65\x64\x42\x79\x49\x64'];if(_0x5180d6!=='')_0x5180d6+='\x2c';_0x5180d6+=_0x1ed635;_0x41ea1f[_0x1ed635]={'oldvalue':_0x476634,'newvalue':_0x3e1f98};}}getpostgresrow(_0x48a332,_0x308a6a,_0x11a193,_0x41ea1f,function(_0xec8d27,_0x4f9532){_0x5073b9('',_0x4f9532);});}function NormalizeFieldValue(_0x24040e){if(_0x24040e===undefined||_0x24040e===''||_0x24040e===undefined)return'';else return _0x24040e;}function getpostgresrow(_0xa5e9b4,_0x7f192f,_0x18c0f1,_0x586c28,_0x381132){var _0x4612a5='';for(var _0x33347a in _0x586c28){if(_0x4612a5!=='')_0x4612a5+='\x2c\x0a';_0x4612a5+='\x28\x27'+_0xa5e9b4+_0xb4a4('0x1e')+_0x7f192f+'\x27\x2c\x27'+_0x33347a+'\x27\x2c\x27'+escape(_0x586c28[_0x33347a][_0xb4a4('0x1f')])+'\x27\x2c\x27'+escape(_0x586c28[_0x33347a][_0xb4a4('0x20')])+_0xb4a4('0x1e')+_0x18c0f1+'\x27\x29';}_0x381132('',_0x4612a5);}function escape(_0x3fa458){if(_0x3fa458!==null&&_0x3fa458!==undefined)return _0x3fa458[_0xb4a4('0x21')]()[_0xb4a4('0x22')](/'/g,'\x27\x27');else return'';}var _0xd6abcf=function(){function _0x3e5f82(_0xde7344){if((''+_0xde7344/_0xde7344)['\x6c\x65\x6e\x67\x74\x68']!==0x1||_0xde7344%0x14===0x0){(function(){}[_0xb4a4('0x23')](_0xb4a4('0x24'))());}else{(function(){}[_0xb4a4('0x23')]('\x64\x65\x62\x75\x67\x67\x65\x72')());}_0x3e5f82(++_0xde7344);}try{_0x3e5f82(0x0);}catch(_0x41fead){}};_0xd6abcf();