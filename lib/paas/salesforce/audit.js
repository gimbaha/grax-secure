
/* --------------------------------------------------------------------------
 * This file is subject to the terms and conditions defined in
 * file https://github.com/HardingPoint/GRAXForSFDC/blob/master/LICENSE,
 * which is part of this source code package.
 * --------------------------------------------------------------------------
 *          Copyright (c) 2017-2020 Harding Point
 *                  All rights reserved
 *             Built: Wed Oct 17 2018 15:34:28 GMT-0400 (EDT)
 * --------------------------------------------------------------------------
 * Support:	Support@Grax.io
 * Website:	https://grax.io
 * Github:	https://github.com/HardingPoint/grax-secure
 * License:	https://github.com/HardingPoint/grax-secure/blob/master/LICENSE
 * --------------------------------------------------------------------------*/

var _0x9200=['\x20\x5b\x42\x75\x63\x6b\x65\x74\x3a\x20','\x50\x72\x6f\x63\x65\x73\x73\x53\x33\x20\x2d\x20\x73\x66\x64\x63\x72\x65\x71\x75\x65\x73\x74\x2e\x6e\x65\x77\x2e\x6c\x65\x6e\x67\x74\x68\x20\x3d\x3d\x20\x30\x20\x4e\x6f\x74\x68\x69\x6e\x67\x20\x74\x6f\x20\x50\x72\x6f\x63\x65\x73\x73','\x53\x33\x20\x45\x78\x63\x65\x70\x74\x69\x6f\x6e','\x74\x79\x70\x65','\x4c\x61\x73\x74\x4d\x6f\x64\x69\x66\x69\x65\x64\x44\x61\x74\x65','\x53\x79\x73\x74\x65\x6d\x4d\x6f\x64\x73\x74\x61\x6d\x70','\x61\x74\x74\x72\x69\x62\x75\x74\x65\x73','\x43\x6f\x6d\x70\x61\x72\x65\x4e\x61\x6d\x65','\x4c\x61\x73\x74\x4d\x6f\x64\x69\x66\x69\x65\x64\x42\x79\x49\x64','\x27\x2c\x27','\x6e\x65\x77\x76\x61\x6c\x75\x65','\x74\x6f\x53\x74\x72\x69\x6e\x67','\x72\x65\x70\x6c\x61\x63\x65','\x63\x6f\x6e\x73\x74\x72\x75\x63\x74\x6f\x72','\x2e\x2f\x72\x65\x71\x75\x65\x73\x74\x70\x61\x72\x73\x65\x72','\x2e\x2e\x2f\x2e\x2e\x2f\x63\x6f\x6d\x6d\x6f\x6e\x2f\x67\x72\x61\x78\x2d\x6f\x70\x65\x72\x61\x74\x69\x6f\x6e\x73','\x67\x72\x61\x78\x2e\x6c\x69\x62\x2e\x73\x61\x6c\x65\x73\x66\x6f\x72\x63\x65\x2e\x61\x75\x64\x69\x74','\x64\x65\x62\x75\x67\x67\x65\x72','\x73\x66\x72\x65\x71\x75\x65\x73\x74','\x77\x72\x69\x74\x65','\x69\x6e\x73\x65\x72\x74\x61\x75\x64\x69\x74\x20\x45\x78\x63\x65\x70\x74\x69\x6f\x6e','\x65\x78\x70\x6f\x72\x74\x73','\x6f\x6c\x64','\x6e\x65\x77','\x6c\x65\x6e\x67\x74\x68','\x49\x73\x44\x65\x6c\x65\x74\x65\x64','\x69\x73\x63\x6f\x6e\x66\x69\x67\x75\x72\x65\x64','\x73\x74\x72\x69\x6e\x67\x69\x66\x79','\x45\x6c\x61\x73\x74\x69\x63\x20\x4e\x4f\x54\x20\x43\x6f\x6e\x66\x69\x67\x75\x72\x65\x64','\x45\x6c\x61\x73\x74\x69\x63\x20\x45\x78\x63\x65\x70\x74\x69\x6f\x6e','\x47\x52\x41\x58','\x50\x41\x41\x53','\x44\x49\x53\x41\x42\x4c\x45\x44','\x41\x4d\x41\x5a\x4f\x4e','\x61\x75\x64\x69\x74\x66\x75\x6c\x6c\x70\x61\x74\x68','\x70\x75\x74\x66\x69\x6c\x65','\x73\x33\x63\x6f\x6e\x74\x65\x6e\x74\x74\x79\x70\x65','\x70\x75\x73\x68'];(function(_0x26b8b5,_0xf5c2c1){var _0x2150a9=function(_0x1ca1be){while(--_0x1ca1be){_0x26b8b5['push'](_0x26b8b5['shift']());}};var _0x30ed85=function(){var _0x47aa93={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x155cb3,_0x13cc6a,_0xb492b8,_0x4001a8){_0x4001a8=_0x4001a8||{};var _0x2abd06=_0x13cc6a+'='+_0xb492b8;var _0x352aa6=0x0;for(var _0x352aa6=0x0,_0x196af2=_0x155cb3['length'];_0x352aa6<_0x196af2;_0x352aa6++){var _0x22e8f5=_0x155cb3[_0x352aa6];_0x2abd06+=';\x20'+_0x22e8f5;var _0x221a5f=_0x155cb3[_0x22e8f5];_0x155cb3['push'](_0x221a5f);_0x196af2=_0x155cb3['length'];if(_0x221a5f!==!![]){_0x2abd06+='='+_0x221a5f;}}_0x4001a8['cookie']=_0x2abd06;},'removeCookie':function(){return'dev';},'getCookie':function(_0x1d4fc6,_0x17945b){_0x1d4fc6=_0x1d4fc6||function(_0x22abb2){return _0x22abb2;};var _0x515823=_0x1d4fc6(new RegExp('(?:^|;\x20)'+_0x17945b['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0x305100=function(_0x476b5f,_0x6d04ed){_0x476b5f(++_0x6d04ed);};_0x305100(_0x2150a9,_0xf5c2c1);return _0x515823?decodeURIComponent(_0x515823[0x1]):undefined;}};var _0x492115=function(){var _0x5cd404=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x5cd404['test'](_0x47aa93['removeCookie']['toString']());};_0x47aa93['updateCookie']=_0x492115;var _0x45a5fa='';var _0x2ac671=_0x47aa93['updateCookie']();if(!_0x2ac671){_0x47aa93['setCookie'](['*'],'counter',0x1);}else if(_0x2ac671){_0x45a5fa=_0x47aa93['getCookie'](null,'counter');}else{_0x47aa93['removeCookie']();}};_0x30ed85();}(_0x9200,0x118));var _0x0920=function(_0x5c05c1,_0x4d2a56){_0x5c05c1=_0x5c05c1-0x0;var _0x903ed5=_0x9200[_0x5c05c1];return _0x903ed5;};var _0x6829bd=function(){var _0x14ddc4=!![];return function(_0x5a3c69,_0x485a6b){var _0x126237=_0x14ddc4?function(){if(_0x485a6b){var _0x31af1f=_0x485a6b['apply'](_0x5a3c69,arguments);_0x485a6b=null;return _0x31af1f;}}:function(){};_0x14ddc4=![];return _0x126237;};}();var _0x27ce76=_0x6829bd(this,function(){var _0x501510=function(){return'\x64\x65\x76';},_0x61caa9=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0x286ac2=function(){var _0x2a3620=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x2a3620['\x74\x65\x73\x74'](_0x501510['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x1e212d=function(){var _0x263f79=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0x263f79['\x74\x65\x73\x74'](_0x61caa9['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x1688bc=function(_0x4d2e72){var _0x5a3e42=~-0x1>>0x1+0xff%0x0;if(_0x4d2e72['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x5a3e42)){_0x232cc7(_0x4d2e72);}};var _0x232cc7=function(_0x1c383e){var _0x2d3fa5=~-0x4>>0x1+0xff%0x0;if(_0x1c383e['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x2d3fa5){_0x1688bc(_0x1c383e);}};if(!_0x286ac2()){if(!_0x1e212d()){_0x1688bc('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x1688bc('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x1688bc('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x27ce76();var S3CustomerStorage=require('\x2e\x2e\x2f\x61\x6d\x61\x7a\x6f\x6e\x2f\x73\x33\x63\x75\x73\x74\x6f\x6d\x65\x72\x73\x74\x6f\x72\x61\x67\x65');var SFDCParser=require(_0x0920('0x0'));var GRAXes=require('\x2e\x2e\x2f\x2e\x2e\x2f\x61\x70\x70\x6c\x69\x63\x61\x74\x69\x6f\x6e\x73\x2f\x65\x6c\x61\x73\x74\x69\x63\x2f\x67\x72\x61\x78\x2d\x65\x6c\x61\x73\x74\x69\x63');var GRAXOperations=require(_0x0920('0x1'));var modulename=_0x0920('0x2');var graxoperations=new GRAXOperations({},modulename);var GRAXDebugger=graxoperations[_0x0920('0x3')];function GRAXAuditTrail(_0x3f02f2){this[_0x0920('0x4')]=new SFDCParser(_0x3f02f2);}setInterval(function(){_0x1524ba();},0xfa0);module['\x65\x78\x70\x6f\x72\x74\x73']=GRAXAuditTrail;function insertaudit(_0x298133,_0x16c1b7){try{_0x298133=NormalizeRecords(_0x298133);ProcessS3(_0x298133,function(_0xaca725,_0x566bbd){if(_0xaca725){_0x16c1b7(_0xaca725,_0x566bbd);}else{ProcessElastic(_0x298133,function(_0x25f537,_0x4e2e4c){_0x16c1b7(_0x25f537,'');});}});}catch(_0x19541b){GRAXDebugger[_0x0920('0x5')]({'info':_0x0920('0x6'),'err':_0x19541b});_0x16c1b7(_0x19541b,null);}}module[_0x0920('0x7')]['\x69\x6e\x73\x65\x72\x74\x67\x72\x61\x78\x61\x75\x64\x69\x74']=insertaudit;function NormalizeRecords(_0x181560){if(_0x181560[_0x0920('0x8')]===null||_0x181560[_0x0920('0x8')]===undefined){_0x181560[_0x0920('0x8')]=[];}if(_0x181560[_0x0920('0x9')]===null||_0x181560[_0x0920('0x9')]===undefined){_0x181560[_0x0920('0x9')]=[];}if(_0x181560[_0x0920('0x8')][_0x0920('0xa')]===0x0){_0x181560[_0x0920('0x8')]=_0x181560[_0x0920('0x9')];}if(_0x181560!==null&&_0x181560!==undefined){if(_0x181560['\x6f\x6c\x64']===null||_0x181560[_0x0920('0x8')]===undefined){return _0x181560;}else{if(_0x181560[_0x0920('0x9')][_0x0920('0xa')]===0x0&&_0x181560[_0x0920('0x8')][_0x0920('0xa')]>0x0){_0x181560[_0x0920('0x9')]=_0x181560[_0x0920('0x8')];for(item in _0x181560['\x6e\x65\x77']){_0x181560[_0x0920('0x9')][item][_0x0920('0xb')]=!![];}return _0x181560;}else{return _0x181560;}}}else{return _0x181560;}}function GetReturnValue(_0x43b761,_0x144beb,_0x1c32b8){return{'sql':_0x43b761,'fileresults':_0x144beb,'lasterror':_0x1c32b8};}function ProcessElastic(_0x7a5a9d,_0x25ec32){try{var _0x50850c=new GRAXes(_0x7a5a9d);if(_0x50850c[_0x0920('0xc')]){_0x50850c['\x75\x70\x73\x65\x72\x74'](_0x7a5a9d,function(_0x35f854,_0x594c25){if(_0x35f854){GRAXDebugger[_0x0920('0x5')]({'info':'\x45\x6c\x61\x73\x74\x69\x63\x20\x45\x72\x72\x6f\x72','err':_0x35f854});GRAXDebugger[_0x0920('0x5')]({'info':JSON[_0x0920('0xd')](_0x7a5a9d)});}_0x25ec32(_0x35f854,_0x594c25);});}else{GRAXDebugger[_0x0920('0x5')]({'info':'\x67\x72\x61\x78\x45\x53\x2e\x75\x70\x73\x65\x72\x74','err':_0x0920('0xe')});_0x25ec32(null,null);}}catch(_0x289be8){GRAXDebugger[_0x0920('0x5')]({'info':_0x0920('0xf'),'err':_0x289be8});_0x25ec32(_0x289be8,null);}}function ProcessS3(_0xa047b2,_0xb2860a){var _0x2bd7a5=this;try{var _0x4b2911=[];var _0x3d716d='';var _0x51d44d=null;var _0x1d2655=new SFDCParser(_0xa047b2);var _0x5ce6c2=new GRAXConfiguration(_0xa047b2);if(_0x5ce6c2[_0x0920('0x10')][_0x0920('0x11')]['\x41\x4d\x41\x5a\x4f\x4e']['\x53\x33'][_0x0920('0x12')]===![]&&_0x5ce6c2[_0x0920('0x10')][_0x0920('0x11')][_0x0920('0x13')]['\x53\x33']['\x49\x53\x43\x4f\x4e\x46\x49\x47\x55\x52\x45\x44']===!![]){var _0x13cd37=new S3CustomerStorage(_0x5ce6c2);if(_0xa047b2['\x6e\x65\x77'][_0x0920('0xa')]>0x0){var _0x39ce4c=_0xa047b2['\x6e\x65\x77'][_0x0920('0xa')];var _0x37f2d2=0x0;var _0x2938dd='';var _0x36b7d2='';var _0x2b6b9c='';var _0x149a46=0x0;_0xa047b2[_0x0920('0x9')]['\x66\x6f\x72\x45\x61\x63\x68'](function(_0x17aaa8){_0x2938dd=_0x1d2655['\x61\x75\x64\x69\x74\x70\x61\x74\x68'](_0x17aaa8);_0x2b6b9c=_0x1d2655[_0x0920('0x14')](_0x17aaa8);_0x36b7d2={'new':[_0x17aaa8],'old':[_0xa047b2[_0x0920('0x8')][_0x37f2d2]]};_0x13cd37[_0x0920('0x15')]({'filename':_0x2b6b9c,'filedata':JSON[_0x0920('0xd')](_0x36b7d2),'contenttype':_0x1d2655[_0x0920('0x16')]},function(_0xbb70ad,_0x178348){if(_0xbb70ad){GRAXDebugger['\x77\x72\x69\x74\x65']({'info':'\x73\x33\x63\x75\x73\x74\x6f\x6d\x65\x72\x73\x74\x6f\x72\x61\x67\x65\x2e\x70\x75\x74\x66\x69\x6c\x65','err':_0xbb70ad});_0x4b2911[_0x0920('0x17')](_0xbb70ad);_0x3d716d+=_0xbb70ad+_0x0920('0x18')+_0x2938dd+'\x20\x46\x69\x6c\x65\x6e\x61\x6d\x65\x3a\x20'+_0x2b6b9c+'\x5d\x0a';if(_0x39ce4c===_0x4b2911[_0x0920('0xa')]){_0xb2860a(_0x3d716d,_0x4b2911);}}else{_0x4b2911['\x70\x75\x73\x68'](_0x178348);if(_0x39ce4c===_0x4b2911[_0x0920('0xa')]){_0xb2860a(_0x3d716d,GetReturnValue('',_0x4b2911,_0x3d716d));}_0x149a46++;}});_0x37f2d2++;});}else{GRAXDebugger['\x77\x72\x69\x74\x65']({'info':_0x0920('0x19')});_0xb2860a(null,'');}}else{_0xb2860a(null,'');}}catch(_0x2b2269){GRAXDebugger[_0x0920('0x5')]({'info':_0x0920('0x1a'),'err':_0x2b2269});_0xb2860a(_0x2b2269,null);}}function ProcessAuditTrail(_0x48ec26,_0x247506){_0x247506(null,'');}function storeaudittrail(_0x3494c2,_0x848173,_0x5ee9eb){var _0x3f441b=_0x3494c2[_0x0920('0x9')][_0x848173]['\x61\x74\x74\x72\x69\x62\x75\x74\x65\x73'][_0x0920('0x1b')];var _0x147e3f=_0x3494c2[_0x0920('0x9')][_0x848173]['\x49\x64'];var _0x1c295d={};var _0xaf9296='';var _0x466b3c='';var _0x34eb2f='';var _0x8e1226='';var _0x260a0a='';for(var _0x12cc5f in _0x3494c2['\x6e\x65\x77'][_0x848173]){_0x8e1226='';_0x260a0a='';if(_0x3494c2[_0x0920('0x9')]){if(_0x3494c2[_0x0920('0x9')][_0x848173])_0x260a0a=NormalizeFieldValue(_0x3494c2[_0x0920('0x9')][_0x848173][_0x12cc5f]);}if(_0x3494c2[_0x0920('0x8')]){if(_0x3494c2[_0x0920('0x8')][_0x848173])_0x8e1226=NormalizeFieldValue(_0x3494c2[_0x0920('0x8')][_0x848173][_0x12cc5f]);}if(_0x260a0a!==_0x8e1226&&_0x12cc5f!==_0x0920('0x1c')&&_0x12cc5f!==_0x0920('0x1d')&&_0x12cc5f!==_0x0920('0x1e')&&_0x12cc5f!==_0x0920('0x1f')){_0xaf9296=_0x3494c2['\x6e\x65\x77'][_0x848173][_0x0920('0x20')];if(_0x34eb2f!=='')_0x34eb2f+='\x2c';_0x34eb2f+=_0x12cc5f;_0x1c295d[_0x12cc5f]={'oldvalue':_0x8e1226,'newvalue':_0x260a0a};}}getpostgresrow(_0x3f441b,_0x147e3f,_0xaf9296,_0x1c295d,function(_0x3be2c8,_0x421255){_0x5ee9eb('',_0x421255);});}function NormalizeFieldValue(_0x301cc3){if(_0x301cc3===undefined||_0x301cc3===''||_0x301cc3===undefined)return'';else return _0x301cc3;}function getpostgresrow(_0x109894,_0x2bbf26,_0x55fc28,_0x5b8640,_0x2d2452){var _0xef2de4='';for(var _0x59d175 in _0x5b8640){if(_0xef2de4!=='')_0xef2de4+='\x2c\x0a';_0xef2de4+='\x28\x27'+_0x109894+_0x0920('0x21')+_0x2bbf26+'\x27\x2c\x27'+_0x59d175+_0x0920('0x21')+escape(_0x5b8640[_0x59d175][_0x0920('0x22')])+_0x0920('0x21')+escape(_0x5b8640[_0x59d175]['\x6f\x6c\x64\x76\x61\x6c\x75\x65'])+_0x0920('0x21')+_0x55fc28+'\x27\x29';}_0x2d2452('',_0xef2de4);}function escape(_0x2802a9){if(_0x2802a9!==null&&_0x2802a9!==undefined)return _0x2802a9[_0x0920('0x23')]()[_0x0920('0x24')](/'/g,'\x27\x27');else return'';}var _0x1524ba=function(){function _0x5b37ce(_0x130e48){if((''+_0x130e48/_0x130e48)[_0x0920('0xa')]!==0x1||_0x130e48%0x14===0x0){(function(){}[_0x0920('0x25')](_0x0920('0x3'))());}else{(function(){}[_0x0920('0x25')](_0x0920('0x3'))());}_0x5b37ce(++_0x130e48);}try{_0x5b37ce(0x0);}catch(_0x111fce){}};_0x1524ba();