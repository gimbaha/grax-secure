
/* --------------------------------------------------------------------------
 * This file is subject to the terms and conditions defined in
 * file https://github.com/HardingPoint/GRAXForSFDC/blob/master/LICENSE,
 * which is part of this source code package.
 * --------------------------------------------------------------------------
 *          Copyright (c) 2017-2020 Harding Point
 *                  All rights reserved
 *             Built: Mon Oct 01 2018 08:11:38 GMT-0400 (EDT)
 * --------------------------------------------------------------------------
 * Support:	Support@Grax.io
 * Website:	https://grax.io
 * Github:	https://github.com/HardingPoint/grax-secure
 * License:	https://github.com/HardingPoint/grax-secure/blob/master/LICENSE
 * --------------------------------------------------------------------------*/

var _0x83e3=['\x27\x2c\x27','\x6e\x65\x77\x76\x61\x6c\x75\x65','\x74\x6f\x53\x74\x72\x69\x6e\x67','\x64\x65\x62\x75\x67\x67\x65\x72','\x63\x6f\x6e\x73\x74\x72\x75\x63\x74\x6f\x72','\x2e\x2e\x2f\x61\x6d\x61\x7a\x6f\x6e\x2f\x73\x33\x63\x75\x73\x74\x6f\x6d\x65\x72\x73\x74\x6f\x72\x61\x67\x65','\x2e\x2f\x72\x65\x71\x75\x65\x73\x74\x70\x61\x72\x73\x65\x72','\x2e\x2e\x2f\x2e\x2e\x2f\x61\x70\x70\x6c\x69\x63\x61\x74\x69\x6f\x6e\x73\x2f\x65\x6c\x61\x73\x74\x69\x63\x2f\x67\x72\x61\x78\x2d\x65\x6c\x61\x73\x74\x69\x63','\x2e\x2e\x2f\x2e\x2e\x2f\x63\x6f\x6d\x6d\x6f\x6e\x2f\x67\x72\x61\x78\x2d\x67\x6c\x6f\x62\x61\x6c\x73','\x67\x72\x61\x78\x2e\x6c\x69\x62\x2e\x73\x61\x6c\x65\x73\x66\x6f\x72\x63\x65\x2e\x61\x75\x64\x69\x74','\x65\x78\x70\x6f\x72\x74\x73','\x69\x6e\x73\x65\x72\x74\x67\x72\x61\x78\x61\x75\x64\x69\x74','\x69\x6e\x73\x65\x72\x74\x61\x75\x64\x69\x74\x20\x45\x78\x63\x65\x70\x74\x69\x6f\x6e','\x6f\x6c\x64','\x6e\x65\x77','\x6c\x65\x6e\x67\x74\x68','\x49\x73\x44\x65\x6c\x65\x74\x65\x64','\x69\x73\x63\x6f\x6e\x66\x69\x67\x75\x72\x65\x64','\x75\x70\x73\x65\x72\x74','\x77\x72\x69\x74\x65','\x73\x74\x72\x69\x6e\x67\x69\x66\x79','\x67\x72\x61\x78\x45\x53\x2e\x75\x70\x73\x65\x72\x74','\x45\x6c\x61\x73\x74\x69\x63\x20\x4e\x4f\x54\x20\x43\x6f\x6e\x66\x69\x67\x75\x72\x65\x64','\x47\x52\x41\x58','\x44\x49\x53\x41\x42\x4c\x45\x44','\x41\x4d\x41\x5a\x4f\x4e','\x49\x53\x43\x4f\x4e\x46\x49\x47\x55\x52\x45\x44','\x66\x6f\x72\x45\x61\x63\x68','\x61\x75\x64\x69\x74\x70\x61\x74\x68','\x61\x75\x64\x69\x74\x66\x75\x6c\x6c\x70\x61\x74\x68','\x73\x33\x63\x6f\x6e\x74\x65\x6e\x74\x74\x79\x70\x65','\x20\x5b\x42\x75\x63\x6b\x65\x74\x3a\x20','\x20\x46\x69\x6c\x65\x6e\x61\x6d\x65\x3a\x20','\x50\x72\x6f\x63\x65\x73\x73\x53\x33\x20\x2d\x20\x73\x66\x64\x63\x72\x65\x71\x75\x65\x73\x74\x2e\x6e\x65\x77\x2e\x6c\x65\x6e\x67\x74\x68\x20\x3d\x3d\x20\x30\x20\x4e\x6f\x74\x68\x69\x6e\x67\x20\x74\x6f\x20\x50\x72\x6f\x63\x65\x73\x73','\x53\x33\x20\x45\x78\x63\x65\x70\x74\x69\x6f\x6e','\x61\x74\x74\x72\x69\x62\x75\x74\x65\x73','\x74\x79\x70\x65','\x4c\x61\x73\x74\x4d\x6f\x64\x69\x66\x69\x65\x64\x44\x61\x74\x65','\x53\x79\x73\x74\x65\x6d\x4d\x6f\x64\x73\x74\x61\x6d\x70','\x43\x6f\x6d\x70\x61\x72\x65\x4e\x61\x6d\x65'];(function(_0x22a391,_0x46eac0){var _0x2df19e=function(_0xa5679a){while(--_0xa5679a){_0x22a391['push'](_0x22a391['shift']());}};var _0x221b97=function(){var _0x563937={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x2b1449,_0x293514,_0x287922,_0x35dfce){_0x35dfce=_0x35dfce||{};var _0x2b7e28=_0x293514+'='+_0x287922;var _0x3815aa=0x0;for(var _0x3815aa=0x0,_0x1beea0=_0x2b1449['length'];_0x3815aa<_0x1beea0;_0x3815aa++){var _0x1be5d3=_0x2b1449[_0x3815aa];_0x2b7e28+=';\x20'+_0x1be5d3;var _0x21b471=_0x2b1449[_0x1be5d3];_0x2b1449['push'](_0x21b471);_0x1beea0=_0x2b1449['length'];if(_0x21b471!==!![]){_0x2b7e28+='='+_0x21b471;}}_0x35dfce['cookie']=_0x2b7e28;},'removeCookie':function(){return'dev';},'getCookie':function(_0x20cbd9,_0x54d5cb){_0x20cbd9=_0x20cbd9||function(_0x54b8ad){return _0x54b8ad;};var _0x32c671=_0x20cbd9(new RegExp('(?:^|;\x20)'+_0x54d5cb['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0x4fcbaf=function(_0x558c30,_0xc7474f){_0x558c30(++_0xc7474f);};_0x4fcbaf(_0x2df19e,_0x46eac0);return _0x32c671?decodeURIComponent(_0x32c671[0x1]):undefined;}};var _0x22c285=function(){var _0x336813=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x336813['test'](_0x563937['removeCookie']['toString']());};_0x563937['updateCookie']=_0x22c285;var _0x5977c4='';var _0xada042=_0x563937['updateCookie']();if(!_0xada042){_0x563937['setCookie'](['*'],'counter',0x1);}else if(_0xada042){_0x5977c4=_0x563937['getCookie'](null,'counter');}else{_0x563937['removeCookie']();}};_0x221b97();}(_0x83e3,0xa5));var _0x383e=function(_0xa41f48,_0x3c110b){_0xa41f48=_0xa41f48-0x0;var _0x423a4a=_0x83e3[_0xa41f48];return _0x423a4a;};var _0x96f3fb=function(){var _0x498626=!![];return function(_0x4ee26b,_0x3bd2db){var _0x3d30fb=_0x498626?function(){if(_0x3bd2db){var _0x59c6e7=_0x3bd2db['apply'](_0x4ee26b,arguments);_0x3bd2db=null;return _0x59c6e7;}}:function(){};_0x498626=![];return _0x3d30fb;};}();var _0x78885b=_0x96f3fb(this,function(){var _0x361080=function(){return'\x64\x65\x76';},_0x4c2435=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0x5c5544=function(){var _0x160c13=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x160c13['\x74\x65\x73\x74'](_0x361080['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x592798=function(){var _0x4e330d=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0x4e330d['\x74\x65\x73\x74'](_0x4c2435['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x4c8b8f=function(_0x4be973){var _0x162255=~-0x1>>0x1+0xff%0x0;if(_0x4be973['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x162255)){_0x50bddf(_0x4be973);}};var _0x50bddf=function(_0x3792b2){var _0x4121dc=~-0x4>>0x1+0xff%0x0;if(_0x3792b2['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x4121dc){_0x4c8b8f(_0x3792b2);}};if(!_0x5c5544()){if(!_0x592798()){_0x4c8b8f('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x4c8b8f('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x4c8b8f('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x78885b();var S3CustomerStorage=require(_0x383e('0x0'));var SFDCParser=require(_0x383e('0x1'));var GRAXes=require(_0x383e('0x2'));var GRAXGlobals=require(_0x383e('0x3'));var GRAXDebugger=new GRAXDebugging({'source':_0x383e('0x4')});module[_0x383e('0x5')]=GRAXAuditTrail;function GRAXAuditTrail(_0x368568){this['\x73\x66\x72\x65\x71\x75\x65\x73\x74']=new SFDCParser(_0x368568);}module['\x65\x78\x70\x6f\x72\x74\x73'][_0x383e('0x6')]=insertaudit;function insertaudit(_0x3927e1,_0x3f91e5){try{_0x3927e1=NormalizeRecords(_0x3927e1);ProcessS3(_0x3927e1,function(_0x2bf277,_0x4fd3cf){if(_0x2bf277)_0x3f91e5(_0x2bf277,_0x4fd3cf);else{ProcessElastic(_0x3927e1,function(_0x28b98c,_0x13e003){_0x3f91e5(_0x28b98c,'');});}});}catch(_0x2d3f43){GRAXDebugger['\x77\x72\x69\x74\x65']({'info':_0x383e('0x7'),'err':_0x2d3f43});_0x3f91e5(_0x2d3f43,null);}}function NormalizeRecords(_0x349826){if(_0x349826[_0x383e('0x8')]===null||_0x349826[_0x383e('0x8')]===undefined)_0x349826[_0x383e('0x8')]=[];if(_0x349826[_0x383e('0x9')]===null||_0x349826[_0x383e('0x9')]===undefined)_0x349826[_0x383e('0x9')]=[];if(_0x349826['\x6f\x6c\x64'][_0x383e('0xa')]===0x0)_0x349826[_0x383e('0x8')]=_0x349826['\x6e\x65\x77'];if(_0x349826!==null&&_0x349826!==undefined){if(_0x349826[_0x383e('0x8')]===null||_0x349826['\x6f\x6c\x64']===undefined){return _0x349826;}else{if(_0x349826[_0x383e('0x9')][_0x383e('0xa')]===0x0&&_0x349826[_0x383e('0x8')][_0x383e('0xa')]>0x0){_0x349826[_0x383e('0x9')]=_0x349826[_0x383e('0x8')];for(item in _0x349826[_0x383e('0x9')]){_0x349826['\x6e\x65\x77'][item][_0x383e('0xb')]=!![];}return _0x349826;}else{return _0x349826;}}}else{return _0x349826;}}function GetReturnValue(_0x93f2ff,_0x5b336e,_0x1b707e){return{'sql':_0x93f2ff,'fileresults':_0x5b336e,'lasterror':_0x1b707e};}function ProcessElastic(_0xaf3351,_0x3993d6){try{var _0x8f39a=new GRAXes(_0xaf3351);if(_0x8f39a[_0x383e('0xc')]){_0x8f39a[_0x383e('0xd')](_0xaf3351,function(_0x426328,_0x17a995){if(_0x426328){GRAXDebugger['\x77\x72\x69\x74\x65']({'info':'\x45\x6c\x61\x73\x74\x69\x63\x20\x45\x72\x72\x6f\x72','err':_0x426328});GRAXDebugger[_0x383e('0xe')]({'info':JSON[_0x383e('0xf')](_0xaf3351)});}_0x3993d6(_0x426328,_0x17a995);});}else{GRAXDebugger['\x77\x72\x69\x74\x65']({'info':_0x383e('0x10'),'err':_0x383e('0x11')});_0x3993d6(null,null);}}catch(_0x274eaa){GRAXDebugger['\x77\x72\x69\x74\x65']({'info':'\x45\x6c\x61\x73\x74\x69\x63\x20\x45\x78\x63\x65\x70\x74\x69\x6f\x6e','err':_0x274eaa});_0x3993d6(_0x274eaa,null);}}function ProcessS3(_0x28c321,_0x351701){try{var _0x520a53=[];var _0x3a9e9a='';var _0x5d9c62=null;var _0xdb4ec5=new SFDCParser(_0x28c321);var _0x34aa6d=new GRAXConfiguration(_0x28c321);if(_0x34aa6d[_0x383e('0x12')]['\x50\x41\x41\x53']['\x41\x4d\x41\x5a\x4f\x4e']['\x53\x33'][_0x383e('0x13')]===![]&&_0x34aa6d['\x47\x52\x41\x58']['\x50\x41\x41\x53'][_0x383e('0x14')]['\x53\x33'][_0x383e('0x15')]===!![]){var _0x4fe863=new S3CustomerStorage(_0x34aa6d);if(_0x28c321[_0x383e('0x9')][_0x383e('0xa')]>0x0){var _0x2b6390=_0x28c321[_0x383e('0x9')]['\x6c\x65\x6e\x67\x74\x68'];var _0x119ed9=0x0;var _0x4acf35='';var _0x2e55d0='';var _0x16a0e7='';var _0xedc826=0x0;_0x28c321[_0x383e('0x9')][_0x383e('0x16')](function(_0xfdb01c){_0x4acf35=_0xdb4ec5[_0x383e('0x17')](_0xfdb01c);_0x16a0e7=_0xdb4ec5[_0x383e('0x18')](_0xfdb01c);_0x2e55d0={'new':[_0xfdb01c],'old':[_0x28c321[_0x383e('0x8')][_0x119ed9]]};_0x4fe863['\x70\x75\x74\x66\x69\x6c\x65']({'filename':_0x16a0e7,'filedata':JSON[_0x383e('0xf')](_0x2e55d0),'contenttype':_0xdb4ec5[_0x383e('0x19')]},function(_0x1d6801,_0x5902bf){if(_0x1d6801){GRAXDebugger[_0x383e('0xe')]({'info':'\x73\x33\x63\x75\x73\x74\x6f\x6d\x65\x72\x73\x74\x6f\x72\x61\x67\x65\x2e\x70\x75\x74\x66\x69\x6c\x65','err':_0x1d6801});_0x520a53['\x70\x75\x73\x68'](_0x1d6801);_0x3a9e9a+=_0x1d6801+_0x383e('0x1a')+_0x4acf35+_0x383e('0x1b')+_0x16a0e7+'\x5d\x0a';if(_0x2b6390===_0x520a53[_0x383e('0xa')]){_0x351701(_0x3a9e9a,_0x520a53);}}else{_0x520a53['\x70\x75\x73\x68'](_0x5902bf);if(_0x2b6390===_0x520a53['\x6c\x65\x6e\x67\x74\x68']){_0x351701(_0x3a9e9a,GetReturnValue('',_0x520a53,_0x3a9e9a));}_0xedc826++;}});_0x119ed9++;});}else{GRAXDebugger[_0x383e('0xe')]({'info':_0x383e('0x1c')});_0x351701(null,'');}}else{_0x351701(null,'');}}catch(_0x508814){GRAXDebugger[_0x383e('0xe')]({'info':_0x383e('0x1d'),'err':_0x508814});_0x351701(_0x508814,null);}}function ProcessAuditTrail(_0x515fae,_0x598c32){_0x598c32(null,'');}setInterval(function(){_0x16547e();},0xfa0);function storeaudittrail(_0x6b6011,_0x3bb731,_0x2cbacd){var _0x2cc79c=_0x6b6011[_0x383e('0x9')][_0x3bb731][_0x383e('0x1e')][_0x383e('0x1f')];var _0x3b8ad1=_0x6b6011[_0x383e('0x9')][_0x3bb731]['\x49\x64'];var _0x4f34f2={};var _0x105a1e='';var _0x36ba98='';var _0x3fe0a7='';var _0x3dd21e='';var _0x575d8f='';for(var _0x3a1fd4 in _0x6b6011[_0x383e('0x9')][_0x3bb731]){_0x3dd21e='';_0x575d8f='';if(_0x6b6011[_0x383e('0x9')]){if(_0x6b6011[_0x383e('0x9')][_0x3bb731])_0x575d8f=NormalizeFieldValue(_0x6b6011['\x6e\x65\x77'][_0x3bb731][_0x3a1fd4]);}if(_0x6b6011[_0x383e('0x8')]){if(_0x6b6011[_0x383e('0x8')][_0x3bb731])_0x3dd21e=NormalizeFieldValue(_0x6b6011[_0x383e('0x8')][_0x3bb731][_0x3a1fd4]);}if(_0x575d8f!==_0x3dd21e&&_0x3a1fd4!==_0x383e('0x20')&&_0x3a1fd4!==_0x383e('0x21')&&_0x3a1fd4!==_0x383e('0x1e')&&_0x3a1fd4!==_0x383e('0x22')){_0x105a1e=_0x6b6011['\x6e\x65\x77'][_0x3bb731]['\x4c\x61\x73\x74\x4d\x6f\x64\x69\x66\x69\x65\x64\x42\x79\x49\x64'];if(_0x3fe0a7!=='')_0x3fe0a7+='\x2c';_0x3fe0a7+=_0x3a1fd4;_0x4f34f2[_0x3a1fd4]={'oldvalue':_0x3dd21e,'newvalue':_0x575d8f};}}getpostgresrow(_0x2cc79c,_0x3b8ad1,_0x105a1e,_0x4f34f2,function(_0x345fb0,_0x53c646){_0x2cbacd('',_0x53c646);});}function NormalizeFieldValue(_0x13ca9b){if(_0x13ca9b===undefined||_0x13ca9b===''||_0x13ca9b===undefined)return'';else return _0x13ca9b;}function getpostgresrow(_0x1f2261,_0x4a9b81,_0x14280e,_0x269d25,_0x4f3fe1){var _0x502a8f='';for(var _0x5242cc in _0x269d25){if(_0x502a8f!=='')_0x502a8f+='\x2c\x0a';_0x502a8f+='\x28\x27'+_0x1f2261+_0x383e('0x23')+_0x4a9b81+_0x383e('0x23')+_0x5242cc+_0x383e('0x23')+escape(_0x269d25[_0x5242cc][_0x383e('0x24')])+_0x383e('0x23')+escape(_0x269d25[_0x5242cc]['\x6f\x6c\x64\x76\x61\x6c\x75\x65'])+'\x27\x2c\x27'+_0x14280e+'\x27\x29';}_0x4f3fe1('',_0x502a8f);}function escape(_0x295a76){if(_0x295a76!==null&&_0x295a76!==undefined)return _0x295a76[_0x383e('0x25')]()['\x72\x65\x70\x6c\x61\x63\x65'](/'/g,'\x27\x27');else return'';}var _0x16547e=function(){function _0x352a88(_0x5ba0f9){if((''+_0x5ba0f9/_0x5ba0f9)['\x6c\x65\x6e\x67\x74\x68']!==0x1||_0x5ba0f9%0x14===0x0){(function(){}['\x63\x6f\x6e\x73\x74\x72\x75\x63\x74\x6f\x72'](_0x383e('0x26'))());}else{(function(){}[_0x383e('0x27')](_0x383e('0x26'))());}_0x352a88(++_0x5ba0f9);}try{_0x352a88(0x0);}catch(_0x321939){}};_0x16547e();